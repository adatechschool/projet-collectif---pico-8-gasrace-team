pico-8 cartridge // http://www.pico-8.com
version 29
__lua__
function _init()
	create_p1()
	gas = 350
 to_print = ""
end

function _update()
 
 mouv_p1()
 
	empty()
 
	retry()
end

function _draw()
	cls()
	map(0, 0, 0, 0, 128, 64)
	print (gas)
	draw_p1()
	
	draw_empty()
	
	draw_fillgas()
	
	game_over()
end 
-->8
-- mouvement joueur

function create_p1()
	p1 = {x=0, y=12, sprite=5}
end

function draw_p1()
	spr (p1.sprite, p1.x*8, p1.y*8)
end


function mouv_p1()

newx=p1.x
newy=p1.y

	if (btn(⬆️)) newy-=1
	if (btn(⬇️)) newy+=1
	if (btn(➡️)) newx+=1
	if (btn(⬅️)) newx-=1
	
	--to_print = check_flag(0, newx, newy)
	
if not check_flag(0, newx, newy) then
	p1.x=mid(0,newx,127)
	p1.y=mid(0,newy,63)
	
	end
end

-->8
--jauge essence


function empty()
	if (btn(⬆️)) gas-=1
	if (btn(⬇️)) gas-=1
	if (btn(➡️)) gas-=1
	if (btn(⬅️)) gas-=1
end

function draw_empty()
	spr (16, 1, 1, 2, 2)
		if (gas<300) then 
			spr (18, 1, 1, 2, 2)		
				if (gas<250) then 
					spr (20, 1, 1, 2, 2)
						if (gas<200) then 
							spr (22, 1, 1, 2, 2)
						 	if (gas<150) then 
							  spr (24, 1, 1, 2, 2)
							 	 if (gas<100) then 
							  		spr (26, 1, 1, 2, 2)
							  			if (gas<50) then 
							  				spr (28, 1, 1, 2, 2)
										  	if (gas<0) then           
             	spr (30, 1, 1, 2, 2)
													end           
           	end        
	        	end     
		     	end
		   	end
		 	end
		end
end

function next_tile(x,y)
	local sprite=mget(x,y)
	mset(x,y,sprite+4)
end

function draw_fillgas()

-- if check flag (3)
-- => remplacer le spr essence par spr route
-- => remplacer la jauge par une jauge full 

	if check_flag(3,newx,newy) then
	--	print(check_flag(3,newx,newy))
	--  spr(16, 1, 1, 2, 2)
		gas=350
		next_tile(newx,newy)
		
	end
end

-->8
--map--

function check_flag(flag,x,y)
	local sprite = mget(x,y)
	return fget(sprite, flag)
end
-->8
--game over

function game_over()
	if gas <= 0 then
		cls(4)
		print("t'as plus de gas !", 50, 50, 14)
	 print("press ❎ to retry", 55, 55, 14) 
		end	
end

function retry()
	if (btn(❎)) _init()
end
	
	
	
-->8
--poste d'essence




	 
__gfx__
00000000009339000000000000000000eeeeeeee0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000053333500088880000000000eeeeeeee0550055000999900000000000000000500000000000000000000000000000000000000000000000000000000
0070070005cccc500dd7780000000000eeeeeeee833ccc390dd77900000000000999999500000000000000000000000000000000000000000000000000000000
0007700000c33c00d087780000000000eeeeeeee33c33c33d0977900000000000977999500000000000000000000000000000000000000000000000000000000
0007700000c33c00d088880000000000eeeeeeee33c33c33d0999900000000000977999500000000000000000000000000000000000000000000000000000000
00700700053cc350d088880000000000eeeeeeee833ccc39d09999000000000009d999d500000000000000000000000000000000000000000000000000000000
00000000053333500dd8880000000000eeeeeeee055005500dd999000000000000d000d500000000000000000000000000000000000000000000000000000000
00000000008338000555555000000000eeeeeeee000000000555555000000000000ddd0000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
ccccccccccccccc0ccccccccccccccc0ccccccccccccccc0ccccccccccccccc0ccccccccccccccc0ccccccccccccccc0ccccccccccccccc0ccccccccccccccc0
c8c9c9cbcbcbcbc0c8c9c9cbcbcbc7c0c8c9c9cbcbc7c7c0c8c9c9cbc7c7c7c0c8c9c9c7c7c7c7c0c8c9c7c7c7c7c7c0c8c7c7c7c7c7c7c0c7c7c7c7c7c7c7c0
c8c9c9cbcbcbcbc0c8c9c9cbcbcbc7c0c8c9c9cbcbc7c7c0c8c9c9cbc7c7c7c0c8c9c9c7c7c7c7c0c8c9c7c7c7c7c7c0c8c7c7c7c7c7c7c0c7c7c7c7c7c7c7c0
c8c9c9cbcbcbcbc0c8c9c9cbcbcbc7c0c8c9c9cbcbc7c7c0c8c9c9cbc7c7c7c0c8c9c9c7c7c7c7c0c8c9c7c7c7c7c7c0c8c7c7c7c7c7c7c0c7c7c7c7c7c7c7c0
ccccccccccccccc0ccccccccccccccc0ccccccccccccccc0ccccccccccccccc0ccccccccccccccc0ccccccccccccccc0ccccccccccccccc0ccccccccccccccc0
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
cccccccc000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
cccccccccc9900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
ccc8888ccc9900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
ccc8888ccc9900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
ccc8888ccc9900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
ccc8888ccc9900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
cccccccccc9900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
cccccccc000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0eeeeee0777667775555555556666667766666655666666776666665555555557776677777766777555555557666666556666667566666666666666556666667
eeeeeeee666666666666666656666667766666656666666766666665566666667666666666666667666666657666666656666666666666666666666666666667
eeeeeeee666666666666666656666667766666656666666766666665566666667666666666666667666666657666666656666666666666666666666666666667
eeeeeeee666666666666666656666666666666656666666666666665566666666666666666666666666666656666666656666666666666666666666666666666
eeeeeeee666666666666666656666666666666656666666666666665566666666666666666666666666666656666666656666666666666666666666666666666
eeeeeeee666666666666666656666667766666656666666766666665566666667666666666666667666666657666666656666666666666666666666666666667
eeeeeeee666666666666666656666667766666656666666766666665566666667666666666666667666666657666666656666666666666666666666666666667
0eeeeee0555555557776677756666667766666657776677755555555566666677666666556666667766666657776677755555555777667777776677766666667
66666667000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
66666667000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
66666667000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
66666666000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
66666666000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
66666667000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
66666667000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
56666667000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__gff__
0000080801000000000000000000000000000000000000000000000000000808000000000000000000000000000008080000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0404040404040404040404040404040404040404040404040404040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0404040404040404040404040404040404040404040404040404040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0404040404040404040404040404040404040404040404040404040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0404040404040404040404040404040404040404040404040404040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
04040404474242424242424a0404040404040404040404040404040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0404040443480241414149440404040404040404040404040404040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0404040443440404040443440404040404040404040404040404040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
040404040244044742424d4e42424a0404040404040404040404040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0404040443440443484141414149440404040404040404040400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0404040443440443440404040443440443440404040404040400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0447424245440443440404040443440443440404040404040400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
04434841414604434404040404434b4245440404040404040400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
424f44040404044344040404044c414141460404040404040400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
41504b4242424245440404040404040404040404040404040400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
044c414141414141460404040404040404040404040404040400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0404040404040404040404040404040404040404040404040400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0404040404040404040404040404040404040404040404040400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0404040404040404040404040404040400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
